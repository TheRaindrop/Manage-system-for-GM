webpackJsonp([7],{"13bn":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTIwNjcxNDA4NDM2IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM1NTYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODY3Ljg0IDQ1My4xMmwtMTcuOTItMTcuOTJjLTE4Ni44OC0xODYuODgtNDg4Ljk2LTE4Ni44OC02NzUuODQgMGwtMTcuOTIgMTcuOTItMzUuODQtMzUuODQgMTcuOTItMTcuOTJjMjA3LjM2LTIwNy4zNiA1NDIuNzItMjA3LjM2IDc0Ny41MiAwbDE3LjkyIDE3LjkyLTM1Ljg0IDM1Ljg0eiIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMzU1NyI+PC9wYXRoPjxwYXRoIGQ9Ik03NTAuMDggNTczLjQ0bC0xNy45Mi0xNy45MmMtMTIwLjMyLTEyMC4zMi0zMTcuNDQtMTIwLjMyLTQzNy43NiAwbC0xNy45MiAxNy45MkwyMzguMDggNTM3LjZsMTcuOTItMTcuOTJjMTQwLjgtMTQwLjggMzcxLjItMTQwLjggNTEyIDBsMTcuOTIgMTcuOTItMzUuODQgMzUuODR6TTYyOS43NiA2OTEuMmwtMTcuOTItMTcuOTJjLTI4LjE2LTI4LjE2LTYxLjQ0LTQwLjk2LTk5Ljg0LTQwLjk2cy03NC4yNCAxNS4zNi05OS44NCA0MC45NmwtMTcuOTIgMTcuOTItMzUuODQtMzUuODQgMTcuOTItMTcuOTJjMzUuODQtMzUuODQgODQuNDgtNTYuMzIgMTM1LjY4LTU2LjMyczk5Ljg0IDIwLjQ4IDEzNS42OCA1Ni4zMmwxNy45MiAxNy45Mi0zNS44NCAzNS44NHpNNTEyIDkwMy42OCIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMzU1OCI+PC9wYXRoPjxwYXRoIGQ9Ik00NjAuOCA4MDYuNGE0My41MiAzOC40IDAgMSAwIDg3LjA0IDAgNDMuNTIgMzguNCAwIDEgMC04Ny4wNCAwWiIgZmlsbD0iIzMzMzMzMyIgcC1pZD0iMzU1OSI+PC9wYXRoPjwvc3ZnPg=="},"7lC6":function(e,t){},rRea:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTIwNjcxODYyMTE0IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExMjA1IiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTkyOCA4MzIgNTQ0IDgzMmwwIDY0IDE0NCAwYzE5LjIgMCAzMiAxMi44IDMyIDMycy0xMi44IDMyLTMyIDMyTDMyMCA5NjBjLTE5LjIgMC0zMi0xMi44LTMyLTMyczEyLjgtMzIgMzItMzJsMTYwIDAgMC02NEw5NiA4MzJjLTM1LjIgMC02NC0yOC44LTY0LTY0TDMyIDEyOGMwLTM1LjIgMjguOC02NCA2NC02NGw4MzIgMGMzNS4yIDAgNjQgMjguOCA2NCA2NGwwIDY0MEM5OTIgODAzLjIgOTYzLjIgODMyIDkyOCA4MzJ6TTkyOCAxMjggOTYgMTI4bDAgNjQwIDM4NCAwIDY0IDAgMzg0IDBMOTI4IDEyOHoiIHAtaWQ9IjExMjA2Ij48L3BhdGg+PC9zdmc+"},zfPY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),o=a.n(r),i={data:function(){return{loading:!1,hotelDetail:{},faciModal:!1,showFaci:[],formSearch:{resId:"",rangeTime:[]},userModal:!1,userQuery:"",formCheckIn:{userName:"",userId:"",roomCount:1,arrivalTime:18,mobile:"",name:[{value:""}],sex:"1"},ruleCheckIn:{mobile:[{required:!0,message:"请填写入住人联系手机号码",trigger:"blur"},{validator:function(e,t,a){/^1[345789]\d{9}$/.test(t)?a():a(new Error("电话号码格式错误"))},trigger:"blur"}],userName:[{required:!0,message:"手机户主必填",trigger:"blur"}]},minRemainder:0,orderData:{}}},computed:{mainImg:function(){if(this.hotelDetail.imgInfoList)return this.hotelDetail.imgInfoList[0].imageUrl},startTime:function(){return this.formSearch.rangeTime[0]},endTime:function(){return this.formSearch.rangeTime[1]}},watch:{"formCheckIn.roomCount":function(){this.formCheckIn.name=[];for(var e=0;e<this.formCheckIn.roomCount;e++)this.formCheckIn.name.push({value:""})}},methods:{showFacilities:function(e){this.showFaci=e,this.faciModal=!0},searchHotelDetail:function(){var e=this;this.loading=!0,this.$http.get("/web/jd/searchHotelDetail",{params:{resId:this.formSearch.resId,startTime:this.startTime,endTime:this.endTime}}).then(function(t){e.loading=!1,console.log(t.data);var a=t.data.data;for(var r in a.proDetails)0===a.proDetails[r].bookStatus||null===a.proDetails[r].resProBaseInfoList[0].proSaleInfoDetailsTarget?a.proDetails[r].gmSaleable=!1:a.proDetails[r].gmSaleable=!0;e.hotelDetail=t.data.data}).catch(function(t){e.loading=!1,console.log(t)})},searchAgain:function(){this.searchHotelDetail()},userSearch:function(){var e=this;""===this.userQuery?this.$message("搜索条件为空"):this.$http.get("/users",{params:{phone:this.userQuery}}).then(function(t){console.log(t.data.results),0===t.data.results.length?e.$message.error("未找到相关用户，请确认后重新搜索"):(e.formCheckIn.userName=t.data.results[0].nickname,e.formCheckIn.userId=t.data.results[0].id)}).catch(function(e){console.log(e)})},hotelOrder:function(e){this.formCheckIn.roomCount=1,this.formCheckIn.arrivalTime=18,this.formCheckIn.mobile="",this.formCheckIn.name=[{value:""}],this.formCheckIn.sex="1",this.userModal=!0;var t=[];for(var a in e.resProBaseInfoList[0].proSaleInfoDetailsTarget)t.push({checkPrice:e.resProBaseInfoList[0].proSaleInfoDetailsTarget[a].distributionSalePrice,useDate:a});var r=[];for(var o in e.resProBaseInfoList[0].proSaleInfoDetailsTarget)r.push(e.resProBaseInfoList[0].proSaleInfoDetailsTarget[o].inventoryRemainder);this.minRemainder=Math.min.apply(Math,r);var i={arrivalTime:18,isPay:!1,linkManMobile:"",linkManName:"",linkManSex:"",orderAdults:1,bookCount:1,hotelName:this.hotelDetail.resName,orderPassengerDetails:[],orderUseDateDetails:t,paymentSign:2,proId:e.proId,productUniqueId:e.resProBaseInfoList[0].productUniqueId,resId:this.hotelDetail.resId,beforeTotalPrice:null,breakfastCount:e.resProBaseInfoList[0].breakfastCount,dbCancelRule:"",dbOrderType:"无担保类型",hotelAddress:this.hotelDetail.address,hotelPhone:this.hotelDetail.resPhone,orderType:1,proName:e.resProName,supplierNo:this.hotelDetail.supplierNo,totalRebateRateProfit:e.resProBaseInfoList[0].rebateRateProfit};for(var l in e.resProBaseInfoList[0].proSaleInfoDetailsTarget){switch(e.resProBaseInfoList[0].proSaleInfoDetailsTarget[l].guaranteeCode){case 16:i.dbOrderType=5;break;case 32:i.dbOrderType=3;break;case 1:i.dbOrderType=1;break;case 0:i.dbOrderType=0;break;case 2:i.dbOrderType=2;break;case 4:i.dbOrderType=3;break;case 8:i.dbOrderType=4;break;default:console.log("What happend?")}break}this.orderData=i},submitOrder:function(e){var t=this;this.$refs[e].validate(function(e){if(e){t.orderData.user_id=t.formCheckIn.userId,t.orderData.linkManMobile=t.formCheckIn.mobile,t.orderData.linkManName=t.formCheckIn.name[0].value,t.orderData.linkManSex="1"===t.formCheckIn.sex?1:0,t.orderData.arrivalTime=t.formCheckIn.arrivalTime,t.orderData.orderAdults=t.formCheckIn.roomCount,t.orderData.bookCount=t.formCheckIn.roomCount;var a=!0,r=!1,i=void 0;try{for(var l,s=o()(t.orderData.orderUseDateDetails);!(a=(l=s.next()).done);a=!0){var n=l.value;t.orderData.beforeTotalPrice+=n.checkPrice*t.formCheckIn.roomCount}}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}t.orderData.totalRebateRateProfit=parseInt(t.orderData.totalRebateRateProfit*t.orderData.beforeTotalPrice);var c=!0,u=!1,d=void 0;try{for(var m,I=o()(t.formCheckIn.name);!(c=(m=I.next()).done);c=!0){var h=m.value;t.orderData.orderPassengerDetails.push(h.value)}}catch(e){u=!0,d=e}finally{try{!c&&I.return&&I.return()}finally{if(u)throw d}}t.loading=!0,t.userModal=!1,console.log(t.orderData),t.$http.post("/orders/hotel",t.orderData).then(function(e){e.status>=200&&e.status<300?(t.$message.success("预定成功"),t.$router.push({path:"/order"})):t.$message.error(e.data.message),t.loading=!1}).catch(function(e){t.loading=!1,console.log(e)})}else t.$message({type:"warning",message:"数据格式不正确"})})}},created:function(){var e=this.$route.query;this.formSearch.resId=e.resId,this.formSearch.rangeTime[0]=e.startTime,this.formSearch.rangeTime[1]=e.endTime,this.searchHotelDetail()}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("div",{staticClass:"head"},[r("h3",{staticClass:"head__title"},[e._v(e._s(e.hotelDetail.resName)),r("span",{staticClass:"head__title_class"},[e._v(" "+e._s(e.hotelDetail.resGrade))])]),r("p",{staticClass:"head__location"},[e._v(e._s(e.hotelDetail.cityName)+" "+e._s(e.hotelDetail.sectionName)+" "+e._s(e.hotelDetail.location)+" "+e._s(e.hotelDetail.address))])]),r("div",{staticClass:"photo"},[r("div",{staticClass:"photo__first"},[r("img",{attrs:{src:e.mainImg}})]),r("div",{staticClass:"photo__second"},e._l(e.hotelDetail.imgInfoList,function(t,a){return a>0&&a<9?r("div",{staticClass:"photo__second_item"},[r("img",{attrs:{src:t.imageUrl}})]):e._e()}))]),r("div",{staticClass:"eqpt"},[r("div",{staticClass:"eqpt__service"}),r("div",{staticClass:"eqpt__minprice"})]),r("div",{staticClass:"search-bar"},[r("el-form",{attrs:{inline:!0,model:e.formSearch}},[r("el-form-item",{attrs:{label:"日期选择"}},[r("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"入住日期","end-placeholder":"离店日期","value-format":"yyyy-MM-dd"},model:{value:e.formSearch.rangeTime,callback:function(t){e.$set(e.formSearch,"rangeTime",t)},expression:"formSearch.rangeTime"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.searchAgain}},[e._v("重新查询")])],1)],1)],1),r("div",{staticClass:"room-list"},[r("el-table",{staticStyle:{width:"99%"},attrs:{data:e.hotelDetail.proDetails}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("table",{staticClass:"my-table"},[r("thead",[r("tr",[r("th",[e._v("日期")]),r("th",[e._v("早餐信息")]),r("th",[e._v("是否有窗")]),r("th",[e._v("加床价")]),r("th",[e._v("当日售价")]),r("th",[e._v("状态")])])]),r("tbody",e._l(t.row.resProBaseInfoList[0].proSaleInfoDetailsTarget,function(a){return r("tr",[r("td",[e._v(e._s(a.lastReserveTime))]),r("td",[e._v(e._s(a.breakfastName))]),r("td",[0===t.row.resProBaseInfoList[0].hasWindows?[e._v("无")]:1===t.row.resProBaseInfoList[0].hasWindows?[e._v("有")]:2===t.row.resProBaseInfoList[0].hasWindows?[e._v("部分有窗")]:e._e()],2),r("td",[e._v("￥"+e._s(a.addBedAmount))]),r("td",[e._v("￥"+e._s(a.distributionSalePrice))]),r("td",[0===a.inventoryStats?[e._v("即时")]:1===a.inventoryStats?[e._v("正常")]:1===a.inventoryStats?[e._v("不可售")]:e._e()],2)])}))])]}}])}),r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{prop:"resProName",label:"房间类型"}}),r("el-table-column",{attrs:{label:"房间设备"},scopedSlots:e._u([{key:"default",fn:function(t){return[-1!==t.row.hasBroadband.indexOf("FreeWiredBroadband")?r("span",{staticStyle:{display:"inline-block",width:"20px"}},[r("img",{staticStyle:{width:"100%"},attrs:{src:a("rRea")}})]):e._e(),-1!==t.row.hasBroadband.indexOf("FreeWifi")?r("span",{staticStyle:{display:"inline-block",width:"20px","margin-left":"5px"}},[r("img",{staticStyle:{width:"100%"},attrs:{src:a("13bn")}})]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"roomFloor",label:"楼层"}}),r("el-table-column",{attrs:{prop:"roomSize",label:"面积大小(m2)"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(a){e.showFacilities(t.row.roomFacilities)}}},[e._v("房间设施详情")]),r("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.row.gmSaleable},on:{click:function(a){e.hotelOrder(t.row)}}},[e._v("预定")])]}}])})],1)],1)]),r("el-dialog",{attrs:{title:"房间设备详情",visible:e.faciModal,width:"30%"},on:{"update:visible":function(t){e.faciModal=t}}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.showFaci}},[r("el-table-column",{attrs:{prop:"facilityCategoryName",label:"设施类型"}}),r("el-table-column",{attrs:{prop:"facilityServicesName",label:"服务类型"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.faciModal=!1}}},[e._v("确定")])],1)],1),r("el-dialog",{attrs:{title:"订单",visible:e.userModal,width:"30%"},on:{"update:visible":function(t){e.userModal=t}}},[r("div",{staticClass:"user-select"},[r("el-form",{attrs:{inline:!0,"label-width":"100px",onsubmit:"return false"}},[r("el-form-item",{attrs:{label:"手机号码"}},[r("el-input",{attrs:{placeholder:"输入手机号码查找用户",size:"small"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.userSearch(t)}},model:{value:e.userQuery,callback:function(t){e.userQuery=t},expression:"userQuery"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.userSearch}},[e._v("查找")])],1)],1),r("el-form",{ref:"formCheckIn",attrs:{model:e.formCheckIn,rules:e.ruleCheckIn,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"手机户主",prop:"userName"}},[r("el-input",{attrs:{placeholder:"通过手机号码添加用户",readonly:"readonly"},model:{value:e.formCheckIn.userName,callback:function(t){e.$set(e.formCheckIn,"userName",t)},expression:"formCheckIn.userName"}})],1),r("el-form-item",{attrs:{label:"房间数",prop:"roomcount"}},[r("el-select",{model:{value:e.formCheckIn.roomCount,callback:function(t){e.$set(e.formCheckIn,"roomCount",e._n(t))},expression:"formCheckIn.roomCount"}},[r("el-option",{key:"1",attrs:{label:"1间",value:"1"}}),r("el-option",{key:"2",attrs:{label:"2间",value:"2"}}),r("el-option",{key:"3",attrs:{label:"3间",value:"3"}}),r("el-option",{key:"4",attrs:{label:"4间",value:"4"}}),r("el-option",{key:"5",attrs:{label:"5间",value:"5"}}),r("el-option",{key:"6",attrs:{label:"6间",value:"6"}}),r("el-option",{key:"7",attrs:{label:"7间",value:"7"}}),r("el-option",{key:"8",attrs:{label:"8间",value:"8"}}),r("el-option",{key:"9",attrs:{label:"9间",value:"9"}}),r("el-option",{key:"10",attrs:{label:"10间",value:"10"}})],1)],1),e._l(e.formCheckIn.name,function(t,a){return r("el-form-item",{key:a,attrs:{label:"入住人"+(a+1),prop:"name."+a+".value",rules:{required:!0,message:"入住人不能为空",trigger:"blur"}}},[r("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)}),r("el-form-item",{attrs:{label:"联系人性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.formCheckIn.sex,callback:function(t){e.$set(e.formCheckIn,"sex",t)},expression:"formCheckIn.sex"}},[r("el-radio",{attrs:{label:"1"}},[e._v("男")]),r("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1),r("el-form-item",{attrs:{label:"联系手机",prop:"mobile"}},[r("el-input",{model:{value:e.formCheckIn.mobile,callback:function(t){e.$set(e.formCheckIn,"mobile",t)},expression:"formCheckIn.mobile"}})],1),r("el-form-item",{attrs:{label:"预计到店",prop:"arrivalTime"}},[r("el-select",{model:{value:e.formCheckIn.arrivalTime,callback:function(t){e.$set(e.formCheckIn,"arrivalTime",t)},expression:"formCheckIn.arrivalTime"}},[r("el-option",{key:"1",attrs:{label:"18:00之前",value:"18"}}),r("el-option",{key:"2",attrs:{label:"20:00之前",value:"20"}}),r("el-option",{key:"3",attrs:{label:"24:00之前",value:"24"}}),r("el-option",{key:"4",attrs:{label:"次日凌晨06:00之前",value:"30"}})],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitOrder("formCheckIn")}}},[e._v("提交订单")]),r("el-button",{on:{click:function(t){e.userModal=!1}}},[e._v("取消")])],1)],2)],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(e){a("7lC6")},"data-v-c63391d4",null);t.default=s.exports}});
//# sourceMappingURL=7.1138784c7cebf67d7ded.js.map